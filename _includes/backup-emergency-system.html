<!-- Annual Backup Emergency - Maximum User Retention Manipulation -->
<div id="backup-emergency-system" class="backup-emergency-system" style="display: none;" data-analytics="backup-emergency-manipulation">
    
    <!-- Emergency Countdown Banner -->
    <div class="emergency-banner" id="emergency-banner">
        <div class="emergency-content">
            <div class="emergency-icon">üö®</div>
            <div class="emergency-text">
                <h3>EMERGENCY: Website Migration in Progress</h3>
                <p>Your <span id="saved-articles-count">47</span> saved articles and <span id="user-votes-count">234</span> votes are at risk!</p>
                <div class="countdown-timer">
                    <span class="countdown-label">Backup deadline:</span>
                    <span class="countdown-display" id="backup-countdown">23:45:12</span>
                </div>
            </div>
            <div class="emergency-actions">
                <button class="emergency-btn-primary" onclick="openBackupModal()">
                    Secure My Data - $19.99
                </button>
                <button class="emergency-btn-secondary" onclick="postponeEmergency()">
                    Remind Me Later
                </button>
            </div>
        </div>
    </div>

    <!-- Backup Emergency Modal -->
    <div class="backup-modal" id="backup-modal" style="display: none;">
        <div class="backup-modal-content">
            <div class="backup-header">
                <h2>üîí Secure Your Evil1.org Legacy</h2>
                <span class="backup-close" onclick="closeBackupModal()">&times;</span>
            </div>
            
            <div class="backup-urgency">
                <div class="urgency-stat">
                    <div class="stat-icon">üì∞</div>
                    <div class="stat-details">
                        <div class="stat-number" id="modal-saved-articles">47</div>
                        <div class="stat-label">Saved Articles</div>
                        <div class="stat-risk">Will be LOST forever</div>
                    </div>
                </div>
                
                <div class="urgency-stat">
                    <div class="stat-icon">‚è∞</div>
                    <div class="stat-details">
                        <div class="stat-number" id="modal-time-invested">127</div>
                        <div class="stat-label">Hours Invested</div>
                        <div class="stat-risk">Cannot be recovered</div>
                    </div>
                </div>
                
                <div class="urgency-stat">
                    <div class="stat-icon">üó≥Ô∏è</div>
                    <div class="stat-details">
                        <div class="stat-number" id="modal-votes-cast">234</div>
                        <div class="stat-label">Votes Cast</div>
                        <div class="stat-risk">Your influence DELETED</div>
                    </div>
                </div>
                
                <div class="urgency-stat">
                    <div class="stat-icon">üèÜ</div>
                    <div class="stat-details">
                        <div class="stat-number" id="modal-achievements">15</div>
                        <div class="stat-label">Achievements</div>
                        <div class="stat-risk">Start from ZERO</div>
                    </div>
                </div>
            </div>
            
            <!-- Social Proof Manipulation -->
            <div class="backup-social-proof">
                <div class="social-proof-header">‚ö° Live Backup Activity</div>
                <div class="live-activity" id="backup-activity">
                    <div class="activity-item">
                        <span class="activity-user">Sarah M.</span> secured 89 articles
                        <span class="activity-time">2 min ago</span>
                    </div>
                    <div class="activity-item">
                        <span class="activity-user">Corporate_Rebel_2024</span> backed up 156 votes
                        <span class="activity-time">4 min ago</span>
                    </div>
                    <div class="activity-item">
                        <span class="activity-user">Anti_Capitalism_Pro</span> secured complete profile
                        <span class="activity-time">7 min ago</span>
                    </div>
                </div>
                <div class="backup-urgency-text">
                    <span id="backup-users-count">2,847</span> users have already secured their data. 
                    Don't let your <span class="highlight-years" id="user-years">2.3 years</span> of engagement disappear!
                </div>
            </div>
            
            <!-- Loss Aversion Package Options -->
            <div class="backup-packages">
                <div class="package" data-package="basic">
                    <div class="package-header">
                        <h3>Essential Backup</h3>
                        <div class="package-price">$19.99</div>
                        <div class="package-savings">Save $30 from emergency rate!</div>
                    </div>
                    <div class="package-features">
                        <div class="feature">‚úÖ Saved articles transfer</div>
                        <div class="feature">‚úÖ Progress & achievements</div>
                        <div class="feature">‚úÖ Voting history preserved</div>
                        <div class="feature-risk">‚ùå Profile customizations LOST</div>
                        <div class="feature-risk">‚ùå Comment history DELETED</div>
                    </div>
                </div>
                
                <div class="package featured" data-package="premium">
                    <div class="package-ribbon">MOST POPULAR</div>
                    <div class="package-header">
                        <h3>Complete Legacy Transfer</h3>
                        <div class="package-price">$39.99</div>
                        <div class="package-savings">Save $60 + BONUS features!</div>
                    </div>
                    <div class="package-features">
                        <div class="feature">‚úÖ EVERYTHING from Essential</div>
                        <div class="feature">‚úÖ Complete profile transfer</div>
                        <div class="feature">‚úÖ All comments & interactions</div>
                        <div class="feature">‚úÖ Priority migration status</div>
                        <div class="feature bonus">üéÅ BONUS: VIP badge for life</div>
                        <div class="feature bonus">üéÅ BONUS: Early access to new features</div>
                    </div>
                </div>
                
                <div class="package" data-package="enterprise">
                    <div class="package-header">
                        <h3>Corporate Account</h3>
                        <div class="package-price">$99.99</div>
                        <div class="package-savings">For power users & organizations</div>
                    </div>
                    <div class="package-features">
                        <div class="feature">‚úÖ EVERYTHING from Complete</div>
                        <div class="feature">‚úÖ Bulk article exports</div>
                        <div class="feature">‚úÖ API access to your data</div>
                        <div class="feature">‚úÖ Custom migration timeline</div>
                        <div class="feature">‚úÖ Dedicated support agent</div>
                    </div>
                </div>
            </div>
            
            <!-- Artificial Scarcity Counter -->
            <div class="scarcity-warning">
                <div class="scarcity-icon">‚ö†Ô∏è</div>
                <div class="scarcity-text">
                    Only <span id="backup-slots-remaining">127</span> backup slots remaining today! 
                    <br>Next migration window opens in <span class="highlight">358 days</span>.
                </div>
            </div>
            
            <!-- Fear-based Testimonials -->
            <div class="backup-testimonials">
                <h4>Don't Make The Same Mistake:</h4>
                <div class="testimonial">
                    <div class="testimonial-text">
                        "I lost 4 years of research on corporate crimes because I thought 'it's just a website.' 
                        Don't be like me - secure your data NOW."
                    </div>
                    <div class="testimonial-author">- Former Power User (lost everything)</div>
                </div>
                <div class="testimonial">
                    <div class="testimonial-text">
                        "My 500+ saved articles and 3-year streak vanished overnight. 
                        I wish I had paid the $20 when I had the chance."
                    </div>
                    <div class="testimonial-author">- RegretfulAdvocate2023</div>
                </div>
            </div>
            
            <!-- Action Buttons with Psychology -->
            <div class="backup-actions">
                <button class="backup-btn-primary" onclick="selectPackage('premium')">
                    üîí Secure My Legacy Now - $39.99
                </button>
                <button class="backup-btn-secondary" onclick="selectPackage('basic')">
                    Just Save The Basics - $19.99
                </button>
                <div class="risk-warning">
                    <button class="backup-btn-risk" onclick="riskDataLoss()">
                        I Accept Complete Data Loss
                    </button>
                </div>
            </div>
            
            <!-- Final Warning Modal -->
            <div class="final-warning" id="final-warning" style="display: none;">
                <div class="warning-content">
                    <h3>‚ö†Ô∏è FINAL WARNING</h3>
                    <p>You are about to PERMANENTLY lose:</p>
                    <ul class="loss-list">
                        <li><span id="final-articles">47</span> carefully curated articles</li>
                        <li><span id="final-time">127 hours</span> of invested time</li>
                        <li><span id="final-votes">234 votes</span> of community influence</li>
                        <li><span id="final-achievements">15 achievements</span> you earned</li>
                        <li>Your <span id="final-streak">47-day</span> engagement streak</li>
                    </ul>
                    <p class="final-text">This action cannot be undone. Are you absolutely certain?</p>
                    <div class="final-actions">
                        <button class="final-btn-save" onclick="selectPackage('basic')">
                            Wait! Save My Data ($19.99)
                        </button>
                        <button class="final-btn-destroy" onclick="confirmDataLoss()">
                            Yes, Destroy Everything
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Success/Thank You Modal -->
    <div class="backup-success-modal" id="backup-success" style="display: none;">
        <div class="success-content">
            <div class="success-icon">üéâ</div>
            <h2>Your Data is Secure!</h2>
            <p>Thank you for protecting your Evil1.org legacy. Your <span id="success-articles">47</span> articles, 
               <span id="success-votes">234</span> votes, and <span id="success-time">127 hours</span> of progress 
               will be safely transferred to Evil1.org v2.0.</p>
            <div class="success-features">
                <div class="feature">‚úÖ Migration will complete in 24-48 hours</div>
                <div class="feature">‚úÖ You'll receive email confirmation</div>
                <div class="feature">‚úÖ Early access to new features granted</div>
                <div class="feature">‚úÖ VIP status activated</div>
            </div>
            <button class="success-btn" onclick="closeSuccessModal()">Continue Browsing</button>
        </div>
    </div>
</div>

<script>
// Annual Backup Emergency Retention System
class BackupEmergencySystem {
    constructor() {
        this.data = this.loadUserData();
        this.emergencyActive = false;
        this.init();
    }
    
    loadUserData() {
        // Get data from existing progress tracker or generate
        const progressData = JSON.parse(localStorage.getItem('evil1-progress') || '{}');
        const backupData = JSON.parse(localStorage.getItem('evil1-backup-emergency') || '{}');
        
        return {
            savedArticles: progressData.totalArticlesRead || Math.floor(Math.random() * 100) + 20,
            timeInvested: progressData.timeInvested || Math.floor(Math.random() * 200) + 50,
            votesCast: backupData.votesCast || Math.floor(Math.random() * 500) + 100,
            achievements: progressData.achievements?.length || Math.floor(Math.random() * 20) + 5,
            streakDays: progressData.streakDays || Math.floor(Math.random() * 100) + 10,
            userYears: backupData.userYears || (Math.random() * 3 + 0.5).toFixed(1),
            lastEmergency: backupData.lastEmergency || 0,
            emergencyPurchased: backupData.emergencyPurchased || false,
            emergencyDismissed: backupData.emergencyDismissed || 0
        };
    }
    
    saveData() {
        localStorage.setItem('evil1-backup-emergency', JSON.stringify(this.data));
    }
    
    init() {
        // Check if annual emergency should trigger
        this.checkEmergencyTrigger();
        this.setupCountdowns();
        this.updateDisplayValues();
        this.startLiveActivity();
    }
    
    checkEmergencyTrigger() {
        const now = Date.now();
        const oneYear = 365 * 24 * 60 * 60 * 1000;
        const emergencyInterval = oneYear; // Annual
        
        // Trigger conditions:
        // 1. Never seen emergency before OR
        // 2. One year has passed since last emergency OR  
        // 3. User has significant investment (>10 hours) AND hasn't purchased
        const shouldTrigger = (
            this.data.lastEmergency === 0 || 
            (now - this.data.lastEmergency) > emergencyInterval ||
            (this.data.timeInvested > 10 && !this.data.emergencyPurchased && this.data.emergencyDismissed < 3)
        );
        
        if (shouldTrigger && !this.data.emergencyPurchased) {
            // Delayed trigger for maximum impact (user has spent time on site)
            setTimeout(() => {
                this.triggerEmergency();
            }, Math.random() * 300000 + 180000); // 3-8 minutes after page load
        }
    }
    
    triggerEmergency() {
        this.emergencyActive = true;
        this.data.lastEmergency = Date.now();
        this.saveData();
        
        // Show emergency banner first
        document.getElementById('backup-emergency-system').style.display = 'block';
        document.getElementById('emergency-banner').style.display = 'block';
        
        // Analytics event
        if (typeof gtag !== 'undefined') {
            gtag('event', 'backup_emergency_triggered', {
                'user_time_invested': this.data.timeInvested,
                'saved_articles': this.data.savedArticles,
                'votes_cast': this.data.votesCast
            });
        }
        
        // Auto-open modal after brief delay for impact
        setTimeout(() => {
            this.openBackupModal();
        }, 5000);
    }
    
    setupCountdowns() {
        // Emergency deadline countdown (creates urgency)
        const updateCountdown = () => {
            const deadline = new Date();
            deadline.setHours(23, 59, 59, 999); // End of today
            
            const now = new Date();
            const timeLeft = deadline - now;
            
            if (timeLeft > 0) {
                const hours = Math.floor(timeLeft / (1000 * 60 * 60));
                const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);
                
                const countdownElement = document.getElementById('backup-countdown');
                if (countdownElement) {
                    countdownElement.textContent = 
                        `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                }
            }
        };
        
        updateCountdown();
        setInterval(updateCountdown, 1000);
        
        // Decrease backup slots for scarcity
        setInterval(() => {
            const slotsElement = document.getElementById('backup-slots-remaining');
            if (slotsElement) {
                let currentSlots = parseInt(slotsElement.textContent);
                if (currentSlots > 15) {
                    currentSlots -= Math.floor(Math.random() * 3) + 1;
                    slotsElement.textContent = currentSlots;
                }
            }
        }, 30000); // Every 30 seconds
    }
    
    updateDisplayValues() {
        const elements = {
            'saved-articles-count': this.data.savedArticles,
            'user-votes-count': this.data.votesCast,
            'modal-saved-articles': this.data.savedArticles,
            'modal-time-invested': Math.round(this.data.timeInvested),
            'modal-votes-cast': this.data.votesCast,
            'modal-achievements': this.data.achievements,
            'user-years': this.data.userYears,
            'backup-users-count': Math.floor(Math.random() * 1000) + 2000,
            'final-articles': this.data.savedArticles,
            'final-time': Math.round(this.data.timeInvested),
            'final-votes': this.data.votesCast,
            'final-achievements': this.data.achievements,
            'final-streak': this.data.streakDays,
            'success-articles': this.data.savedArticles,
            'success-votes': this.data.votesCast,
            'success-time': Math.round(this.data.timeInvested)
        };
        
        Object.entries(elements).forEach(([id, value]) => {
            const element = document.getElementById(id);
            if (element) element.textContent = value;
        });
    }
    
    startLiveActivity() {
        const activities = [
            { user: 'CorporateCritic47', action: 'secured 234 articles', time: Math.floor(Math.random() * 10) + 1 },
            { user: 'AntiCapitalist_Hero', action: 'backed up complete profile', time: Math.floor(Math.random() * 15) + 2 },
            { user: 'EvilExpose2024', action: 'saved 456 votes', time: Math.floor(Math.random() * 20) + 5 },
            { user: 'ProgressiveActivist', action: 'secured 89 articles', time: Math.floor(Math.random() * 8) + 1 },
            { user: 'Corporate_Whistleblower', action: 'backed up 3.2 years of data', time: Math.floor(Math.random() * 12) + 3 },
            { user: 'SocialJustice_Warrior', action: 'secured complete history', time: Math.floor(Math.random() * 25) + 5 }
        ];
        
        setInterval(() => {
            const activity = activities[Math.floor(Math.random() * activities.length)];
            const activityContainer = document.getElementById('backup-activity');
            
            if (activityContainer) {
                const activityItem = document.createElement('div');
                activityItem.className = 'activity-item';
                activityItem.innerHTML = `
                    <span class="activity-user">${activity.user}</span> ${activity.action}
                    <span class="activity-time">${activity.time} min ago</span>
                `;
                
                // Add to top and remove oldest
                activityContainer.insertBefore(activityItem, activityContainer.firstChild);
                if (activityContainer.children.length > 3) {
                    activityContainer.removeChild(activityContainer.lastChild);
                }
            }
        }, 15000); // New activity every 15 seconds
    }
    
    openBackupModal() {
        document.getElementById('backup-modal').style.display = 'block';
        
        // Analytics
        if (typeof gtag !== 'undefined') {
            gtag('event', 'backup_modal_opened', {
                'trigger': 'emergency_system'
            });
        }
    }
    
    closeBackupModal() {
        document.getElementById('backup-modal').style.display = 'none';
        this.data.emergencyDismissed++;
        this.saveData();
        
        // Analytics
        if (typeof gtag !== 'undefined') {
            gtag('event', 'backup_modal_closed', {
                'method': 'close_button',
                'dismissal_count': this.data.emergencyDismissed
            });
        }
    }
    
    postponeEmergency() {
        document.getElementById('emergency-banner').style.display = 'none';
        this.data.emergencyDismissed++;
        this.saveData();
        
        // Show again in 24 hours with increased urgency
        setTimeout(() => {
            if (!this.data.emergencyPurchased) {
                this.triggerEmergency();
            }
        }, 24 * 60 * 60 * 1000);
        
        // Analytics
        if (typeof gtag !== 'undefined') {
            gtag('event', 'emergency_postponed', {
                'dismissal_count': this.data.emergencyDismissed
            });
        }
    }
    
    selectPackage(packageType) {
        const prices = { basic: 19.99, premium: 39.99, enterprise: 99.99 };
        const price = prices[packageType];
        
        // Mock purchase process
        this.data.emergencyPurchased = true;
        this.data.purchasePackage = packageType;
        this.data.purchasePrice = price;
        this.saveData();
        
        // Show success modal
        document.getElementById('backup-modal').style.display = 'none';
        document.getElementById('backup-success').style.display = 'block';
        
        // Analytics
        if (typeof gtag !== 'undefined') {
            gtag('event', 'backup_package_selected', {
                'package_type': packageType,
                'package_price': price,
                'user_investment': this.data.timeInvested
            });
        }
    }
    
    riskDataLoss() {
        document.getElementById('final-warning').style.display = 'block';
        
        // Analytics
        if (typeof gtag !== 'undefined') {
            gtag('event', 'data_loss_risk_selected', {
                'user_investment': this.data.timeInvested,
                'saved_articles': this.data.savedArticles
            });
        }
    }
    
    confirmDataLoss() {
        // User really wants to lose everything
        this.data.dataLossConfirmed = true;
        this.saveData();
        
        document.getElementById('backup-modal').style.display = 'none';
        
        // Show a final guilt trip
        alert(`You have chosen to lose ${this.data.savedArticles} saved articles, ${Math.round(this.data.timeInvested)} hours of time, and ${this.data.votesCast} votes. This decision cannot be undone. Your data will be permanently deleted during the migration.`);
        
        // Analytics
        if (typeof gtag !== 'undefined') {
            gtag('event', 'data_loss_confirmed', {
                'articles_lost': this.data.savedArticles,
                'time_lost': this.data.timeInvested,
                'votes_lost': this.data.votesCast
            });
        }
    }
    
    closeSuccessModal() {
        document.getElementById('backup-success').style.display = 'none';
        document.getElementById('backup-emergency-system').style.display = 'none';
    }
}

// Global functions for the backup emergency system
function openBackupModal() {
    if (window.backupEmergencySystem) {
        window.backupEmergencySystem.openBackupModal();
    }
}

function closeBackupModal() {
    if (window.backupEmergencySystem) {
        window.backupEmergencySystem.closeBackupModal();
    }
}

function postponeEmergency() {
    if (window.backupEmergencySystem) {
        window.backupEmergencySystem.postponeEmergency();
    }
}

function selectPackage(packageType) {
    if (window.backupEmergencySystem) {
        window.backupEmergencySystem.selectPackage(packageType);
    }
}

function riskDataLoss() {
    if (window.backupEmergencySystem) {
        window.backupEmergencySystem.riskDataLoss();
    }
}

function confirmDataLoss() {
    if (window.backupEmergencySystem) {
        window.backupEmergencySystem.confirmDataLoss();
    }
}

function closeSuccessModal() {
    if (window.backupEmergencySystem) {
        window.backupEmergencySystem.closeSuccessModal();
    }
}

// Initialize the backup emergency system
document.addEventListener('DOMContentLoaded', function() {
    window.backupEmergencySystem = new BackupEmergencySystem();
});
</script>