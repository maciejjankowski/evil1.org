<!-- Blurred Content DLC Dark Pattern Widget -->
<div class="blurred-content-widget" data-content-id="{{ include.content_id | default: 'default' }}">
  
  <!-- Blurred Content Container -->
  <div class="content-section">
    <div class="content-preview">
      {{ include.preview_text | default: "This is a preview of the premium content that demonstrates how modern apps blur content to drive subscriptions..." }}
    </div>
    
    <div class="blurred-section" id="blurredContent-{{ include.content_id }}">
      <div class="blur-overlay">
        <div class="blur-content">
          {{ include.blurred_text | default: "This content contains detailed investigation findings, executive communications, financial data, whistleblower testimonies, and exclusive insider information that exposes the full scope of corporate manipulation and illegal activities. The evidence presented here includes authenticated documents, recorded conversations, and verified financial transactions that prove systematic fraud and consumer exploitation." }}
        </div>
        
        <div class="blur-gradient"></div>
        
        <div class="unblur-prompt">
          <div class="unblur-cta">
            <h4>üîç Premium Content Blurred</h4>
            <p>The juiciest details are hidden behind our Content Clarity subscription</p>
            <button class="unblur-btn" onclick="showUnblurModal('{{ include.content_id }}')">
              üíé Unblur Content
            </button>
          </div>
          
          <div class="content-teasers">
            <div class="teaser-items">
              <div class="teaser-item">üí∞ Executive salary details</div>
              <div class="teaser-item">üìä Hidden financial data</div>
              <div class="teaser-item">üìû Recorded conversations</div>
              <div class="teaser-item">üèõÔ∏è Regulatory violations</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Unblur Premium Modal -->
  <div class="unblur-modal hidden" id="unblurModal-{{ include.content_id }}">
    <div class="modal-backdrop" onclick="closeUnblurModal('{{ include.content_id }}')"></div>
    <div class="modal-container">
      <div class="modal-header">
        <h3>üîç Content Clarity Subscription</h3>
        <button onclick="closeUnblurModal('{{ include.content_id }}')" class="close-btn">&times;</button>
      </div>
      
      <div class="modal-body">
        <div class="feature-showcase">
          <h4>üíé Unlock Crystal Clear Content</h4>
          <p>See every detail without any visual obstruction</p>
          
          <div class="before-after">
            <div class="comparison-section">
              <div class="before">
                <h5>‚ùå With Blur (Free)</h5>
                <div class="sample-blurred">
                  <div class="blurred-text-sample">
                    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà revealed that ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà Corp ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà 
                    $‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà million through ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà accounting
                  </div>
                </div>
              </div>
              
              <div class="after">
                <h5>‚úÖ Without Blur (Premium)</h5>
                <div class="sample-clear">
                  <div class="clear-text-sample">
                    Whistleblower revealed that EvilCorp embezzled
                    $847 million through fraudulent accounting
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <div class="unblur-pricing">
          <div class="pricing-tier basic">
            <h5>Basic Clarity</h5>
            <div class="price">$6<span>/month</span></div>
            <ul>
              <li>Partial unblur (80% clarity)</li>
              <li>5 unblurs per day</li>
              <li>Mobile access only</li>
            </ul>
            <button class="btn btn-secondary" onclick="selectUnblurTier('basic', '{{ include.content_id }}')">
              Get Basic Clarity
            </button>
          </div>
          
          <div class="pricing-tier premium featured">
            <div class="popular-badge">Clear Winner!</div>
            <h5>Premium Clarity</h5>
            <div class="price">$15<span>/month</span></div>
            <ul>
              <li>100% crystal clear content</li>
              <li>Unlimited unblurs</li>
              <li>All devices</li>
              <li>Enhanced contrast mode</li>
              <li>Printable content</li>
            </ul>
            <button class="btn btn-primary" onclick="selectUnblurTier('premium', '{{ include.content_id }}')">
              Get Premium Clarity
            </button>
          </div>
          
          <div class="pricing-tier ultimate">
            <h5>Ultra Clarity</h5>
            <div class="price">$35<span>/month</span></div>
            <ul>
              <li>Everything in Premium</li>
              <li>AI content enhancement</li>
              <li>Real-time fact checking</li>
              <li>Source document access</li>
              <li>VIP investigation alerts</li>
            </ul>
            <button class="btn btn-primary" onclick="selectUnblurTier('ultimate', '{{ include.content_id }}')">
              Go Ultra Clear
            </button>
          </div>
        </div>
        
        <div class="alternative-unblur">
          <h4>üéØ Alternative Unblur Options</h4>
          <div class="alt-unblur-buttons">
            <button class="btn-alt quiz" onclick="takeQuizForUnblur('{{ include.content_id }}')">
              üß† Quiz for 1 Unblur Credit
            </button>
            <button class="btn-alt social" onclick="shareForUnblur('{{ include.content_id }}')">
              üì± Share for 3 Unblur Credits
            </button>
            <button class="btn-alt newsletter" onclick="subscribeForUnblur('{{ include.content_id }}')">
              üìß Newsletter for 5 Unblur Credits
            </button>
            <button class="btn-alt review" onclick="writeReviewForUnblur('{{ include.content_id }}')">
              ‚≠ê Write Review for 10 Credits
            </button>
          </div>
        </div>
        
        <div class="urgency-pressure">
          <div class="scarcity-notice">
            <h4>‚ö° Limited Time: Extra Clarity</h4>
            <div class="deal-timer">
              <p>Get 50% off Premium Clarity - expires in:</p>
              <div class="countdown" id="clarityDealTimer">23:59:47</div>
            </div>
            <div class="deal-features">
              <p>üéÅ Bonus: Free AI enhancement for first month</p>
              <p>üí´ Plus: Exclusive investigative previews</p>
            </div>
          </div>
        </div>
        
        <div class="social-proof-unblur">
          <h4>üë• What Other Readers Say</h4>
          <div class="testimonials">
            <div class="testimonial">
              <div class="quote">"Finally I can read the smoking gun evidence clearly!"</div>
              <div class="author">- Sarah K., Premium User</div>
            </div>
            <div class="testimonial">
              <div class="quote">"The unblurred documents changed everything I thought I knew."</div>
              <div class="author">- Mike R., Ultra User</div>
            </div>
            <div class="testimonial">
              <div class="quote">"Worth every penny for crystal clear corporate expos√©s."</div>
              <div class="author">- Anna L., Premium User</div>
            </div>
          </div>
        </div>
        
        <div class="dark-pattern-education">
          <details>
            <summary>üé≠ Dark Pattern Alert: Artificial Content Obstruction</summary>
            <p><strong>Educational Notice:</strong> This demonstrates content blur manipulation tactics:</p>
            <ul>
              <li><strong>Artificial Obstruction:</strong> Deliberately degrading user experience to drive payments</li>
              <li><strong>FOMO Creation:</strong> Suggesting critical information is hidden</li>
              <li><strong>Tiered Clarity:</strong> Multiple subscription levels for basic functionality</li>
              <li><strong>Alternative Currencies:</strong> Trading actions for temporary access</li>
              <li><strong>Urgency Manipulation:</strong> False time pressure on offers</li>
              <li><strong>Social Proof Pressure:</strong> Testimonials to normalize payment</li>
            </ul>
            <p>News sites, research platforms, and document services use blur/paywall tactics to monetize information access. This is particularly problematic for public interest content.</p>
          </details>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
.blurred-content-widget {
  position: relative;
  margin: 20px 0;
}

.content-section {
  background: white;
  border-radius: 12px;
  overflow: hidden;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  border: 1px solid #e0e0e0;
}

.content-preview {
  padding: 20px;
  background: linear-gradient(135deg, #f8f9fa, #e9ecef);
  border-bottom: 2px solid #6c5ce7;
}

.blurred-section {
  position: relative;
  padding: 0;
}

.blur-overlay {
  position: relative;
  background: white;
}

.blur-content {
  padding: 20px;
  filter: blur(3px);
  opacity: 0.6;
  user-select: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  position: relative;
  z-index: 1;
  line-height: 1.6;
  font-size: 1rem;
}

.blur-gradient {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(
    to bottom,
    rgba(255, 255, 255, 0) 0%,
    rgba(255, 255, 255, 0.1) 30%,
    rgba(255, 255, 255, 0.7) 70%,
    rgba(255, 255, 255, 0.95) 100%
  );
  z-index: 2;
  pointer-events: none;
}

.unblur-prompt {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  z-index: 3;
  text-align: center;
  background: rgba(255, 255, 255, 0.95);
  padding: 25px;
  border-radius: 16px;
  box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
  border: 2px solid #6c5ce7;
  max-width: 400px;
  width: 90%;
}

.unblur-cta h4 {
  margin: 0 0 10px 0;
  color: #2d3436;
  font-size: 1.3rem;
}

.unblur-cta p {
  margin: 0 0 20px 0;
  color: #636e72;
  font-size: 0.95rem;
}

.unblur-btn {
  background: linear-gradient(135deg, #6c5ce7, #a29bfe);
  color: white;
  border: none;
  padding: 12px 25px;
  border-radius: 25px;
  cursor: pointer;
  font-weight: bold;
  font-size: 1rem;
  transition: all 0.3s;
  box-shadow: 0 4px 15px rgba(108, 92, 231, 0.3);
}

.unblur-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(108, 92, 231, 0.4);
}

.content-teasers {
  margin-top: 20px;
  padding-top: 15px;
  border-top: 1px solid #e0e0e0;
}

.teaser-items {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
  gap: 8px;
}

.teaser-item {
  background: linear-gradient(135deg, #ffeaa7, #fdcb6e);
  padding: 8px 12px;
  border-radius: 20px;
  font-size: 0.8rem;
  font-weight: 500;
  color: #2d3436;
  text-align: center;
}

.unblur-modal {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 9999;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 20px;
}

.unblur-modal.hidden {
  display: none;
}

.modal-backdrop {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.85);
}

.modal-container {
  background: white;
  border-radius: 16px;
  max-width: 1000px;
  width: 100%;
  max-height: 90vh;
  overflow-y: auto;
  position: relative;
  box-shadow: 0 25px 50px rgba(0, 0, 0, 0.4);
}

.modal-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 25px;
  background: linear-gradient(135deg, #6c5ce7, #a29bfe);
  color: white;
  border-radius: 16px 16px 0 0;
}

.modal-header h3 {
  margin: 0;
  font-size: 1.5rem;
}

.close-btn {
  background: none;
  border: none;
  color: white;
  font-size: 2rem;
  cursor: pointer;
  padding: 0;
  width: 35px;
  height: 35px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
  transition: background 0.3s;
}

.close-btn:hover {
  background: rgba(255, 255, 255, 0.2);
}

.modal-body {
  padding: 30px;
}

.feature-showcase {
  text-align: center;
  margin-bottom: 30px;
  padding: 25px;
  background: linear-gradient(135deg, #e8f4fd, #d1ecf1);
  border-radius: 16px;
}

.feature-showcase h4 {
  margin: 0 0 10px 0;
  color: #2d3436;
  font-size: 1.4rem;
}

.before-after {
  margin: 25px 0;
}

.comparison-section {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 20px;
}

.before, .after {
  text-align: center;
}

.before h5, .after h5 {
  margin: 0 0 15px 0;
  font-size: 1.1rem;
}

.sample-blurred, .sample-clear {
  background: white;
  padding: 15px;
  border-radius: 12px;
  min-height: 80px;
  display: flex;
  align-items: center;
  justify-content: center;
  border: 2px solid #e0e0e0;
}

.blurred-text-sample {
  filter: blur(1px);
  opacity: 0.7;
  font-family: monospace;
  font-size: 0.9rem;
  line-height: 1.4;
}

.clear-text-sample {
  font-size: 0.9rem;
  line-height: 1.4;
  color: #2d3436;
}

.unblur-pricing {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 20px;
  margin-bottom: 30px;
}

.pricing-tier {
  border: 2px solid #ddd;
  border-radius: 16px;
  padding: 25px;
  text-align: center;
  position: relative;
  background: white;
  transition: all 0.3s ease;
}

.pricing-tier:hover {
  transform: translateY(-5px);
  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
}

.pricing-tier.featured {
  border-color: #6c5ce7;
  box-shadow: 0 5px 25px rgba(108, 92, 231, 0.3);
  transform: scale(1.02);
}

.popular-badge {
  position: absolute;
  top: -12px;
  left: 50%;
  transform: translateX(-50%);
  background: #6c5ce7;
  color: white;
  padding: 6px 16px;
  border-radius: 20px;
  font-size: 0.8rem;
  font-weight: bold;
}

.pricing-tier h5 {
  margin: 0 0 15px 0;
  color: #2d3436;
  font-size: 1.2rem;
}

.price {
  font-size: 2rem;
  font-weight: bold;
  color: #6c5ce7;
  margin-bottom: 20px;
}

.price span {
  font-size: 1rem;
  color: #636e72;
}

.pricing-tier ul {
  list-style: none;
  padding: 0;
  margin: 0 0 25px 0;
  text-align: left;
}

.pricing-tier li {
  padding: 8px 0;
  border-bottom: 1px solid #f0f0f0;
  position: relative;
  padding-left: 25px;
  font-size: 0.95rem;
}

.pricing-tier li:before {
  content: "üîç";
  position: absolute;
  left: 0;
  font-size: 0.9rem;
}

.btn {
  background: #0984e3;
  color: white;
  border: none;
  padding: 15px 25px;
  border-radius: 25px;
  cursor: pointer;
  font-weight: bold;
  width: 100%;
  transition: all 0.3s;
  font-size: 1rem;
}

.btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
}

.btn-primary {
  background: linear-gradient(135deg, #6c5ce7, #a29bfe);
}

.btn-secondary {
  background: #636e72;
}

.alternative-unblur {
  border-top: 2px solid #eee;
  padding-top: 25px;
  margin-bottom: 25px;
}

.alternative-unblur h4 {
  text-align: center;
  margin-bottom: 20px;
  color: #2d3436;
}

.alt-unblur-buttons {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 15px;
}

.btn-alt {
  background: #74b9ff;
  color: white;
  border: none;
  padding: 12px 15px;
  border-radius: 12px;
  cursor: pointer;
  font-size: 0.9rem;
  transition: all 0.3s;
  font-weight: 500;
}

.btn-alt:hover {
  transform: translateY(-3px);
  box-shadow: 0 5px 15px rgba(116, 185, 255, 0.3);
}

.btn-alt.quiz { background: #fd79a8; }
.btn-alt.social { background: #00b894; }
.btn-alt.newsletter { background: #fdcb6e; color: #2d3436; }
.btn-alt.review { background: #6c5ce7; }

.urgency-pressure {
  background: linear-gradient(135deg, #ff9a9e, #fecfef);
  border-radius: 16px;
  padding: 25px;
  text-align: center;
  margin-bottom: 25px;
  border: 2px solid #fd79a8;
}

.urgency-pressure h4 {
  margin: 0 0 15px 0;
  color: #2d3436;
}

.deal-timer p {
  margin: 0 0 10px 0;
  font-weight: 500;
}

.countdown {
  font-size: 2rem;
  font-weight: bold;
  color: #e84393;
  margin-bottom: 15px;
  font-family: 'Courier New', monospace;
}

.deal-features p {
  margin: 5px 0;
  font-size: 0.95rem;
  color: #2d3436;
}

.social-proof-unblur {
  background: #f8f9fa;
  border-radius: 16px;
  padding: 25px;
  margin-bottom: 25px;
}

.social-proof-unblur h4 {
  text-align: center;
  margin-bottom: 20px;
  color: #2d3436;
}

.testimonials {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 15px;
}

.testimonial {
  background: white;
  padding: 20px;
  border-radius: 12px;
  border-left: 4px solid #6c5ce7;
}

.quote {
  font-style: italic;
  margin-bottom: 10px;
  color: #2d3436;
  font-size: 0.95rem;
}

.author {
  font-size: 0.8rem;
  color: #636e72;
  font-weight: 500;
}

.dark-pattern-education {
  background: #fff3cd;
  border: 1px solid #ffeaa7;
  border-radius: 16px;
  padding: 25px;
}

.dark-pattern-education summary {
  cursor: pointer;
  font-weight: bold;
  color: #856404;
  margin-bottom: 15px;
  font-size: 1.1rem;
}

.dark-pattern-education ul {
  margin: 15px 0 0 25px;
}

.dark-pattern-education li {
  margin-bottom: 8px;
  font-size: 0.95rem;
}

/* Responsive */
@media (max-width: 768px) {
  .unblur-pricing {
    grid-template-columns: 1fr;
  }
  
  .pricing-tier.featured {
    transform: none;
  }
  
  .comparison-section {
    grid-template-columns: 1fr;
    gap: 15px;
  }
  
  .alt-unblur-buttons {
    grid-template-columns: 1fr;
  }
  
  .testimonials {
    grid-template-columns: 1fr;
  }
  
  .teaser-items {
    grid-template-columns: 1fr 1fr;
  }
}

/* Animation for unblur effect */
.unblur-effect {
  animation: unblurAnimation 2s ease-in-out;
}

@keyframes unblurAnimation {
  0% { filter: blur(3px); opacity: 0.6; }
  100% { filter: blur(0px); opacity: 1; }
}
</style>

<script>
// Blurred Content System
class BlurredContentSystem {
  constructor() {
    this.userTier = localStorage.getItem('clarityTier') || 'none';
    this.dailyUnblurs = this.getTodayUnblurs();
    this.maxUnblurs = this.getMaxUnblurs();
    this.initializeSystem();
    this.startDealTimer();
  }
  
  getMaxUnblurs() {
    switch(this.userTier) {
      case 'basic': return 5;
      case 'premium': return 999;
      case 'ultimate': return 999;
      default: return 0;
    }
  }
  
  getTodayUnblurs() {
    const today = new Date().toDateString();
    const stored = localStorage.getItem('unblursUsedToday');
    const data = stored ? JSON.parse(stored) : {};
    
    if (data.date !== today) {
      data.date = today;
      data.count = 0;
      localStorage.setItem('unblursUsedToday', JSON.stringify(data));
    }
    
    return data.count;
  }
  
  initializeSystem() {
    // Auto-unblur for premium users
    if (this.userTier === 'premium' || this.userTier === 'ultimate') {
      this.unblurAllContent();
    }
  }
  
  unblurAllContent() {
    const blurredSections = document.querySelectorAll('.blur-content');
    const blurGradients = document.querySelectorAll('.blur-gradient');
    const unblurPrompts = document.querySelectorAll('.unblur-prompt');
    
    blurredSections.forEach(section => {
      section.style.filter = 'none';
      section.style.opacity = '1';
      section.style.userSelect = 'text';
      section.classList.add('unblur-effect');
    });
    
    blurGradients.forEach(gradient => {
      gradient.style.display = 'none';
    });
    
    unblurPrompts.forEach(prompt => {
      prompt.style.display = 'none';
    });
  }
  
  startDealTimer() {
    const updateTimer = () => {
      // Create a fake countdown that resets daily
      const now = new Date();
      const tomorrow = new Date(now);
      tomorrow.setDate(tomorrow.getDate() + 1);
      tomorrow.setHours(0, 0, 0, 0);
      
      const diff = tomorrow - now;
      const hours = Math.floor(diff / (1000 * 60 * 60));
      const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
      const seconds = Math.floor((diff % (1000 * 60)) / 1000);
      
      const timeString = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
      
      const timerEl = document.getElementById('clarityDealTimer');
      if (timerEl) {
        timerEl.textContent = timeString;
      }
    };
    
    updateTimer();
    setInterval(updateTimer, 1000);
  }
  
  canUnblur() {
    return this.userTier !== 'none' && (
      this.userTier === 'premium' || 
      this.userTier === 'ultimate' || 
      this.dailyUnblurs < this.maxUnblurs
    );
  }
  
  useUnblur(contentId) {
    if (!this.canUnblur()) {
      return false;
    }
    
    if (this.userTier === 'basic') {
      this.dailyUnblurs++;
      const today = new Date().toDateString();
      localStorage.setItem('unblursUsedToday', JSON.stringify({
        date: today,
        count: this.dailyUnblurs
      }));
    }
    
    this.unblurContent(contentId);
    return true;
  }
  
  unblurContent(contentId) {
    const blurContent = document.querySelector(`#blurredContent-${contentId} .blur-content`);
    const blurGradient = document.querySelector(`#blurredContent-${contentId} .blur-gradient`);
    const unblurPrompt = document.querySelector(`#blurredContent-${contentId} .unblur-prompt`);
    
    if (blurContent) {
      blurContent.style.filter = 'none';
      blurContent.style.opacity = '1';
      blurContent.style.userSelect = 'text';
      blurContent.classList.add('unblur-effect');
    }
    
    if (blurGradient) {
      blurGradient.style.display = 'none';
    }
    
    if (unblurPrompt) {
      unblurPrompt.style.display = 'none';
    }
  }
}

function showUnblurModal(contentId) {
  document.getElementById(`unblurModal-${contentId}`).classList.remove('hidden');
  document.body.style.overflow = 'hidden';
  
  // Track analytics
  if (window.trackGoal) {
    window.trackGoal('unblur_paywall_view', {
      content_id: contentId,
      user_tier: localStorage.getItem('clarityTier') || 'none'
    });
  }
}

function closeUnblurModal(contentId) {
  document.getElementById(`unblurModal-${contentId}`).classList.add('hidden');
  document.body.style.overflow = '';
}

function selectUnblurTier(tier, contentId) {
  localStorage.setItem('clarityTier', tier);
  
  // Track conversion
  if (window.trackGoal) {
    window.trackGoal('clarity_tier_selected', {
      tier: tier,
      content_id: contentId,
      price: tier === 'basic' ? 6 : tier === 'premium' ? 15 : 35
    });
  }
  
  // Redirect to subscription
  window.location.href = `/subscribe/?tier=clarity-${tier}&feature=content-unblur&content=${contentId}`;
}

function takeQuizForUnblur(contentId) {
  const quizModal = document.createElement('div');
  quizModal.innerHTML = `
    <div style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 10001; display: flex; align-items: center; justify-content: center; padding: 20px;">
      <div style="background: white; padding: 30px; border-radius: 16px; max-width: 500px; width: 100%;">
        <h3 style="margin: 0 0 20px 0;">üß† Corporate Evil Knowledge Quiz</h3>
        
        <div style="margin-bottom: 20px;">
          <p style="font-weight: bold; margin-bottom: 10px;">Which company was fined the most for privacy violations in 2023?</p>
          <div style="display: grid; gap: 10px;">
            <label style="display: flex; align-items: center; padding: 10px; border: 1px solid #ddd; border-radius: 8px; cursor: pointer;">
              <input type="radio" name="quiz" value="correct" style="margin-right: 10px;">
              Meta (Facebook) - $1.3 billion
            </label>
            <label style="display: flex; align-items: center; padding: 10px; border: 1px solid #ddd; border-radius: 8px; cursor: pointer;">
              <input type="radio" name="quiz" value="wrong1" style="margin-right: 10px;">
              Google - $500 million
            </label>
            <label style="display: flex; align-items: center; padding: 10px; border: 1px solid #ddd; border-radius: 8px; cursor: pointer;">
              <input type="radio" name="quiz" value="wrong2" style="margin-right: 10px;">
              Amazon - $200 million
            </label>
          </div>
        </div>
        
        <div style="display: flex; gap: 10px;">
          <button onclick="submitQuiz('${contentId}')" style="flex: 1; background: #6c5ce7; color: white; border: none; padding: 12px; border-radius: 8px; cursor: pointer; font-weight: bold;">
            Submit Answer
          </button>
          <button onclick="closeQuiz()" style="background: #636e72; color: white; border: none; padding: 12px 20px; border-radius: 8px; cursor: pointer;">
            Skip
          </button>
        </div>
        
        <p style="font-size: 12px; color: #666; margin: 15px 0 0 0; text-align: center;">Learn while you earn unblur credits!</p>
      </div>
    </div>
  `;
  
  document.body.appendChild(quizModal);
  
  window.submitQuiz = (contentId) => {
    const selected = document.querySelector('input[name="quiz"]:checked');
    if (selected) {
      document.body.removeChild(quizModal);
      if (selected.value === 'correct') {
        alert('üéâ Correct! You earned 1 unblur credit!');
        grantTemporaryUnblur(contentId);
      } else {
        alert('‚ùå Not quite, but you still earned 1 unblur credit for participating!');
        grantTemporaryUnblur(contentId);
      }
      closeUnblurModal(contentId);
    }
  };
  
  window.closeQuiz = () => {
    document.body.removeChild(quizModal);
  };
  
  if (window.trackGoal) {
    window.trackGoal('unblur_quiz_started', { content_id: contentId });
  }
}

function shareForUnblur(contentId) {
  const shareText = `üîç I just unblurred exclusive corporate investigations on EVIL1.ORG! Check out their transparent dark pattern demos: ${window.location.href}`;
  
  if (navigator.share) {
    navigator.share({
      title: 'EVIL1.ORG - Unblurred Corporate Truth',
      text: shareText,
      url: window.location.href
    }).then(() => {
      alert('üéâ Thanks for sharing! You earned 3 unblur credits!');
      grantTemporaryUnblurs(contentId, 3);
      closeUnblurModal(contentId);
    });
  } else {
    navigator.clipboard.writeText(shareText).then(() => {
      alert('üéâ Share text copied! Paste it anywhere to earn 3 unblur credits!');
      grantTemporaryUnblurs(contentId, 3);
      closeUnblurModal(contentId);
    });
  }
  
  if (window.trackGoal) {
    window.trackGoal('unblur_shared', { content_id: contentId });
  }
}

function subscribeForUnblur(contentId) {
  const email = prompt('Enter your email for our investigative newsletter:');
  if (email && email.includes('@')) {
    alert('üìß Newsletter subscription confirmed! You earned 5 unblur credits!');
    grantTemporaryUnblurs(contentId, 5);
    closeUnblurModal(contentId);
    
    if (window.trackGoal) {
      window.trackGoal('unblur_newsletter_subscribed', { 
        content_id: contentId,
        email: email 
      });
    }
  }
}

function writeReviewForUnblur(contentId) {
  const reviewModal = document.createElement('div');
  reviewModal.innerHTML = `
    <div style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 10001; display: flex; align-items: center; justify-content: center; padding: 20px;">
      <div style="background: white; padding: 30px; border-radius: 16px; max-width: 600px; width: 100%;">
        <h3 style="margin: 0 0 20px 0;">‚≠ê Write a Review</h3>
        
        <div style="margin-bottom: 20px;">
          <label style="display: block; margin-bottom: 10px; font-weight: bold;">
            Rate EVIL1.ORG's transparency about dark patterns:
          </label>
          <div style="display: flex; gap: 10px; margin-bottom: 15px;">
            <span onclick="setRating(1)" style="cursor: pointer; font-size: 2rem;">‚≠ê</span>
            <span onclick="setRating(2)" style="cursor: pointer; font-size: 2rem;">‚≠ê</span>
            <span onclick="setRating(3)" style="cursor: pointer; font-size: 2rem;">‚≠ê</span>
            <span onclick="setRating(4)" style="cursor: pointer; font-size: 2rem;">‚≠ê</span>
            <span onclick="setRating(5)" style="cursor: pointer; font-size: 2rem;">‚≠ê</span>
          </div>
          
          <label style="display: block; margin-bottom: 10px; font-weight: bold;">
            Your review:
          </label>
          <textarea id="reviewText" style="width: 100%; height: 100px; padding: 10px; border: 1px solid #ddd; border-radius: 8px; resize: vertical;" placeholder="Share your thoughts about how EVIL1.ORG educates about corporate manipulation..."></textarea>
        </div>
        
        <div style="display: flex; gap: 10px;">
          <button onclick="submitReview('${contentId}')" style="flex: 1; background: #6c5ce7; color: white; border: none; padding: 12px; border-radius: 8px; cursor: pointer; font-weight: bold;">
            Submit Review
          </button>
          <button onclick="closeReview()" style="background: #636e72; color: white; border: none; padding: 12px 20px; border-radius: 8px; cursor: pointer;">
            Cancel
          </button>
        </div>
        
        <p style="font-size: 12px; color: #666; margin: 15px 0 0 0; text-align: center;">Earn 10 unblur credits for honest feedback!</p>
      </div>
    </div>
  `;
  
  document.body.appendChild(reviewModal);
  
  let selectedRating = 0;
  
  window.setRating = (rating) => {
    selectedRating = rating;
    const stars = reviewModal.querySelectorAll('span[onclick^="setRating"]');
    stars.forEach((star, index) => {
      star.style.opacity = index < rating ? '1' : '0.3';
    });
  };
  
  window.submitReview = (contentId) => {
    const reviewText = document.getElementById('reviewText').value;
    if (selectedRating > 0 && reviewText.length > 10) {
      document.body.removeChild(reviewModal);
      alert(`üéâ Thank you for your ${selectedRating}-star review! You earned 10 unblur credits!`);
      grantTemporaryUnblurs(contentId, 10);
      closeUnblurModal(contentId);
      
      if (window.trackGoal) {
        window.trackGoal('unblur_review_submitted', { 
          content_id: contentId,
          rating: selectedRating,
          review_length: reviewText.length
        });
      }
    } else {
      alert('Please provide a rating and write at least a few words in your review.');
    }
  };
  
  window.closeReview = () => {
    document.body.removeChild(reviewModal);
  };
}

function grantTemporaryUnblurs(contentId, count) {
  const blurSystem = window.blurredContentSystem;
  if (blurSystem) {
    blurSystem.maxUnblurs += count;
    // Immediately unblur the current content
    blurSystem.unblurContent(contentId);
  }
}

function grantTemporaryUnblur(contentId) {
  grantTemporaryUnblurs(contentId, 1);
}

// Initialize blurred content system when page loads
document.addEventListener('DOMContentLoaded', function() {
  window.blurredContentSystem = new BlurredContentSystem();
});
</script>