<!-- Daily Article Limit DLC Dark Pattern Widget -->
<div class="article-limit-widget" id="articleLimitWidget">
  <!-- Article Access Check Overlay -->
  <div class="article-access-overlay hidden" id="articleAccessOverlay">
    <div class="access-modal">
      <div class="modal-header">
        <h3>üìö Daily Article Limit Reached</h3>
        <button onclick="closeArticleModal()" class="close-btn">&times;</button>
      </div>
      
      <div class="modal-content">
        <div class="limit-explanation">
          <div class="limit-visual">
            <div class="article-counter">
              <span class="counter-number" id="articlesUsed">3</span>
              <span class="counter-label">articles read today</span>
            </div>
            <div class="limit-bar">
              <div class="limit-progress" id="limitProgress"></div>
            </div>
            <p class="limit-message">You've reached your daily limit of free articles</p>
          </div>
        </div>
        
        <div class="upgrade-options">
          <h4>üìñ Unlock Unlimited Reading</h4>
          
          <div class="reading-tiers">
            <div class="tier basic">
              <h5>Basic Reader</h5>
              <div class="price">$4<span>/month</span></div>
              <ul>
                <li>15 articles per day</li>
                <li>Basic bookmarking</li>
                <li>Mobile reading</li>
              </ul>
              <button class="btn btn-secondary" onclick="selectReadingTier('basic')">
                Upgrade to Basic
              </button>
            </div>
            
            <div class="tier premium featured">
              <div class="popular-badge">Most Popular</div>
              <h5>Premium Reader</h5>
              <div class="price">$12<span>/month</span></div>
              <ul>
                <li>Unlimited articles</li>
                <li>Offline reading</li>
                <li>Article highlights</li>
                <li>Reading analytics</li>
                <li>Ad-free experience</li>
              </ul>
              <button class="btn btn-primary" onclick="selectReadingTier('premium')">
                Go Premium
              </button>
            </div>
            
            <div class="tier unlimited">
              <h5>Scholar Mode</h5>
              <div class="price">$29<span>/month</span></div>
              <ul>
                <li>Everything in Premium</li>
                <li>Early access to articles</li>
                <li>Exclusive investigative reports</li>
                <li>Direct author contact</li>
                <li>Research collaboration</li>
              </ul>
              <button class="btn btn-primary" onclick="selectReadingTier('unlimited')">
                Become a Scholar
              </button>
            </div>
          </div>
        </div>
        
        <div class="alternative-access">
          <h4>üéØ Alternative Access Options</h4>
          <div class="access-buttons">
            <button class="btn-alt video" onclick="watchVideoForArticle()">
              üìπ Watch 60s Video for 1 Article
            </button>
            <button class="btn-alt social" onclick="shareForArticles()">
              üì± Share Article for 2 More
            </button>
            <button class="btn-alt survey" onclick="takeSurveyForArticles()">
              üìã Take Survey for 3 Articles
            </button>
            <button class="btn-alt invite" onclick="inviteFriendForArticles()">
              üë• Invite Friend for 10 Articles
            </button>
          </div>
        </div>
        
        <div class="daily-reset-info">
          <div class="reset-countdown">
            <h4>‚è∞ Reset Information</h4>
            <p>Your reading limit resets in:</p>
            <div class="countdown-display">
              <span id="resetCountdown">23:42:15</span>
            </div>
            <div class="timezone-info">
              <small>Resets at midnight in your timezone</small>
            </div>
          </div>
        </div>
        
        <div class="retention-pressure">
          <div class="social-proof">
            <h4>üî• Join the Reading Community</h4>
            <div class="reader-stats">
              <div class="stat">
                <span class="stat-number">47,293</span>
                <span class="stat-label">Active Readers</span>
              </div>
              <div class="stat">
                <span class="stat-number">1.2M</span>
                <span class="stat-label">Articles Read</span>
              </div>
              <div class="stat">
                <span class="stat-number">94%</span>
                <span class="stat-label">Upgrade Rate</span>
              </div>
            </div>
            <p class="social-message">Most readers upgrade within their first week</p>
          </div>
        </div>
        
        <div class="dark-pattern-education">
          <details>
            <summary>üé≠ Dark Pattern Alert: Freemium Content Limits</summary>
            <p><strong>Educational Notice:</strong> This demonstrates classic freemium content restriction strategies:</p>
            <ul>
              <li><strong>Artificial Scarcity:</strong> Limiting access to unlimited digital content</li>
              <li><strong>Daily Limits:</strong> Creating habitual checking and FOMO</li>
              <li><strong>Alternative Currencies:</strong> Trading attention/data for access</li>
              <li><strong>Social Pressure:</strong> Using community stats to encourage upgrades</li>
              <li><strong>Time Pressure:</strong> Daily reset timers create urgency</li>
              <li><strong>Graduated Commitment:</strong> Multiple tiers to capture different price points</li>
            </ul>
            <p>News sites, Medium, and educational platforms use these exact mechanics to convert free users to paid subscribers.</p>
          </details>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Daily Limit Status Bar (appears on all pages) -->
  <div class="daily-limit-status" id="dailyLimitStatus">
    <div class="status-content">
      <div class="limit-info">
        <span class="articles-remaining" id="articlesRemaining">2</span>
        <span class="limit-text">free articles remaining today</span>
      </div>
      <div class="upgrade-prompt">
        <button class="upgrade-btn" onclick="showArticleModal()">
          Upgrade for Unlimited
        </button>
      </div>
    </div>
  </div>
</div>

<style>
.article-limit-widget {
  position: relative;
}

.article-access-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.85);
  z-index: 9999;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 20px;
}

.article-access-overlay.hidden {
  display: none;
}

.access-modal {
  background: white;
  border-radius: 16px;
  max-width: 900px;
  width: 100%;
  max-height: 90vh;
  overflow-y: auto;
  box-shadow: 0 25px 50px rgba(0, 0, 0, 0.4);
}

.modal-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 25px;
  background: linear-gradient(135deg, #667eea, #764ba2);
  color: white;
  border-radius: 16px 16px 0 0;
}

.modal-header h3 {
  margin: 0;
  font-size: 1.6rem;
}

.close-btn {
  background: none;
  border: none;
  color: white;
  font-size: 2rem;
  cursor: pointer;
  padding: 0;
  width: 35px;
  height: 35px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
  transition: background 0.3s;
}

.close-btn:hover {
  background: rgba(255, 255, 255, 0.2);
}

.modal-content {
  padding: 30px;
}

.limit-explanation {
  text-align: center;
  margin-bottom: 30px;
  padding: 25px;
  background: linear-gradient(135deg, #ffeaa7, #fdcb6e);
  border-radius: 16px;
}

.limit-visual {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 15px;
}

.article-counter {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 5px;
}

.counter-number {
  font-size: 3rem;
  font-weight: bold;
  color: #d63031;
  line-height: 1;
}

.counter-label {
  font-size: 1rem;
  color: #2d3436;
  font-weight: 500;
}

.limit-bar {
  width: 300px;
  height: 20px;
  background: #f0f0f0;
  border-radius: 10px;
  overflow: hidden;
  position: relative;
}

.limit-progress {
  height: 100%;
  background: linear-gradient(90deg, #ff6b6b, #ee5a24);
  border-radius: 10px;
  transition: width 0.3s ease;
  width: 100%; /* Will be set by JavaScript */
}

.limit-message {
  margin: 10px 0 0 0;
  color: #2d3436;
  font-weight: 500;
  font-size: 1.1rem;
}

.upgrade-options h4 {
  text-align: center;
  margin-bottom: 25px;
  color: #2d3436;
  font-size: 1.4rem;
}

.reading-tiers {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 20px;
  margin-bottom: 30px;
}

.tier {
  border: 2px solid #ddd;
  border-radius: 16px;
  padding: 25px;
  text-align: center;
  position: relative;
  background: white;
  transition: all 0.3s ease;
}

.tier:hover {
  transform: translateY(-5px);
  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
}

.tier.featured {
  border-color: #667eea;
  box-shadow: 0 5px 25px rgba(102, 126, 234, 0.3);
  transform: scale(1.02);
}

.popular-badge {
  position: absolute;
  top: -12px;
  left: 50%;
  transform: translateX(-50%);
  background: #667eea;
  color: white;
  padding: 6px 16px;
  border-radius: 20px;
  font-size: 0.8rem;
  font-weight: bold;
}

.tier h5 {
  margin: 0 0 15px 0;
  color: #2d3436;
  font-size: 1.2rem;
}

.price {
  font-size: 2rem;
  font-weight: bold;
  color: #667eea;
  margin-bottom: 20px;
}

.price span {
  font-size: 1rem;
  color: #636e72;
}

.tier ul {
  list-style: none;
  padding: 0;
  margin: 0 0 25px 0;
  text-align: left;
}

.tier li {
  padding: 8px 0;
  border-bottom: 1px solid #f0f0f0;
  position: relative;
  padding-left: 25px;
  font-size: 0.95rem;
}

.tier li:before {
  content: "üìñ";
  position: absolute;
  left: 0;
  font-size: 0.9rem;
}

.btn {
  background: #0984e3;
  color: white;
  border: none;
  padding: 15px 25px;
  border-radius: 25px;
  cursor: pointer;
  font-weight: bold;
  width: 100%;
  transition: all 0.3s;
  font-size: 1rem;
}

.btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
}

.btn-primary {
  background: linear-gradient(135deg, #667eea, #764ba2);
}

.btn-secondary {
  background: #636e72;
}

.alternative-access {
  border-top: 2px solid #eee;
  padding-top: 25px;
  margin-bottom: 25px;
}

.alternative-access h4 {
  text-align: center;
  margin-bottom: 20px;
  color: #2d3436;
}

.access-buttons {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 15px;
}

.btn-alt {
  background: #a29bfe;
  color: white;
  border: none;
  padding: 12px 15px;
  border-radius: 12px;
  cursor: pointer;
  font-size: 0.9rem;
  transition: all 0.3s;
  font-weight: 500;
}

.btn-alt:hover {
  background: #6c5ce7;
  transform: translateY(-3px);
  box-shadow: 0 5px 15px rgba(108, 92, 231, 0.3);
}

.btn-alt.video { background: #e84393; }
.btn-alt.social { background: #00b894; }
.btn-alt.survey { background: #fdcb6e; color: #2d3436; }
.btn-alt.invite { background: #fd79a8; }

.daily-reset-info {
  background: #e8f4fd;
  border: 2px solid #74b9ff;
  border-radius: 16px;
  padding: 25px;
  text-align: center;
  margin-bottom: 25px;
}

.reset-countdown h4 {
  margin: 0 0 10px 0;
  color: #0984e3;
}

.countdown-display {
  font-size: 2rem;
  font-weight: bold;
  color: #0984e3;
  margin: 15px 0;
  font-family: 'Courier New', monospace;
}

.timezone-info {
  color: #636e72;
  margin-top: 10px;
}

.retention-pressure {
  background: linear-gradient(135deg, #ff9a9e, #fecfef);
  border-radius: 16px;
  padding: 25px;
  text-align: center;
  margin-bottom: 25px;
}

.retention-pressure h4 {
  margin: 0 0 20px 0;
  color: #2d3436;
}

.reader-stats {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 20px;
  margin-bottom: 15px;
}

.stat {
  background: white;
  padding: 15px;
  border-radius: 12px;
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
}

.stat-number {
  display: block;
  font-size: 1.8rem;
  font-weight: bold;
  color: #e84393;
  line-height: 1;
}

.stat-label {
  font-size: 0.8rem;
  color: #636e72;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin-top: 5px;
  display: block;
}

.social-message {
  margin: 0;
  color: #2d3436;
  font-weight: 500;
}

.daily-limit-status {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  background: linear-gradient(135deg, #ff6b6b, #ee5a24);
  color: white;
  z-index: 1000;
  padding: 10px 0;
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
}

.status-content {
  max-width: 1200px;
  margin: 0 auto;
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0 20px;
}

.limit-info {
  display: flex;
  align-items: center;
  gap: 10px;
}

.articles-remaining {
  font-size: 1.5rem;
  font-weight: bold;
  background: rgba(255, 255, 255, 0.2);
  padding: 5px 12px;
  border-radius: 20px;
}

.limit-text {
  font-weight: 500;
}

.upgrade-btn {
  background: white;
  color: #ff6b6b;
  border: none;
  padding: 8px 20px;
  border-radius: 20px;
  cursor: pointer;
  font-weight: bold;
  transition: all 0.3s;
  font-size: 0.9rem;
}

.upgrade-btn:hover {
  background: #f0f0f0;
  transform: translateY(-1px);
}

.dark-pattern-education {
  background: #fff3cd;
  border: 1px solid #ffeaa7;
  border-radius: 16px;
  padding: 25px;
}

.dark-pattern-education summary {
  cursor: pointer;
  font-weight: bold;
  color: #856404;
  margin-bottom: 15px;
  font-size: 1.1rem;
}

.dark-pattern-education ul {
  margin: 15px 0 0 25px;
}

.dark-pattern-education li {
  margin-bottom: 8px;
  font-size: 0.95rem;
}

/* Responsive */
@media (max-width: 768px) {
  .reading-tiers {
    grid-template-columns: 1fr;
  }
  
  .tier.featured {
    transform: none;
  }
  
  .access-buttons {
    grid-template-columns: 1fr;
  }
  
  .reader-stats {
    grid-template-columns: 1fr;
    gap: 10px;
  }
  
  .status-content {
    flex-direction: column;
    gap: 10px;
    text-align: center;
  }
  
  .daily-limit-status {
    position: relative;
  }
}

/* Hide status bar for premium users */
.daily-limit-status.premium-user {
  display: none;
}
</style>

<script>
// Daily Article Limit System
class DailyArticleLimitSystem {
  constructor() {
    this.userTier = localStorage.getItem('readingTier') || 'free';
    this.dailyLimit = this.getDailyLimit();
    this.articlesRead = this.getTodayArticlesRead();
    this.initializeSystem();
    this.startResetTimer();
    this.checkArticleAccess();
  }
  
  getDailyLimit() {
    switch(this.userTier) {
      case 'basic': return 15;
      case 'premium': return 999;
      case 'unlimited': return 999;
      default: return 3; // free tier
    }
  }
  
  getTodayArticlesRead() {
    const today = new Date().toDateString();
    const stored = localStorage.getItem('articlesReadToday');
    const data = stored ? JSON.parse(stored) : {};
    
    if (data.date !== today) {
      // Reset for new day
      data.date = today;
      data.count = 0;
      localStorage.setItem('articlesReadToday', JSON.stringify(data));
    }
    
    return data.count;
  }
  
  initializeSystem() {
    this.updateStatusBar();
    this.updateModalContent();
    
    // Track article views
    this.trackArticleView();
  }
  
  trackArticleView() {
    // Only track on article pages
    if (this.isArticlePage()) {
      this.articlesRead++;
      const today = new Date().toDateString();
      localStorage.setItem('articlesReadToday', JSON.stringify({
        date: today,
        count: this.articlesRead
      }));
      
      this.updateStatusBar();
      this.checkArticleAccess();
      
      // Track analytics
      if (window.trackGoal) {
        window.trackGoal('article_read', {
          tier: this.userTier,
          articles_read_today: this.articlesRead,
          limit_reached: this.articlesRead >= this.dailyLimit
        });
      }
    }
  }
  
  isArticlePage() {
    // Check if current page is an article
    return window.location.pathname.includes('/articles/') || 
           document.querySelector('article') || 
           document.querySelector('.post-content') ||
           document.querySelector('[data-article-content]');
  }
  
  checkArticleAccess() {
    if (this.userTier === 'free' && this.articlesRead >= this.dailyLimit) {
      // Show paywall after a brief delay
      setTimeout(() => {
        this.showArticleModal();
      }, 3000);
    }
  }
  
  updateStatusBar() {
    const statusBar = document.getElementById('dailyLimitStatus');
    const remainingEl = document.getElementById('articlesRemaining');
    
    if (this.userTier !== 'free') {
      statusBar.classList.add('premium-user');
      return;
    }
    
    const remaining = Math.max(0, this.dailyLimit - this.articlesRead);
    if (remainingEl) {
      remainingEl.textContent = remaining;
    }
    
    // Change color based on remaining articles
    if (remaining === 0) {
      statusBar.style.background = 'linear-gradient(135deg, #d63031, #e17055)';
    } else if (remaining === 1) {
      statusBar.style.background = 'linear-gradient(135deg, #fdcb6e, #e17055)';
    }
  }
  
  updateModalContent() {
    const usedEl = document.getElementById('articlesUsed');
    const progressEl = document.getElementById('limitProgress');
    
    if (usedEl) {
      usedEl.textContent = this.articlesRead;
    }
    
    if (progressEl) {
      const percentage = (this.articlesRead / this.dailyLimit) * 100;
      progressEl.style.width = Math.min(percentage, 100) + '%';
    }
  }
  
  showArticleModal() {
    document.getElementById('articleAccessOverlay').classList.remove('hidden');
    document.body.style.overflow = 'hidden';
    
    // Track paywall view
    if (window.trackGoal) {
      window.trackGoal('article_limit_paywall_view', {
        articles_read: this.articlesRead,
        tier: this.userTier
      });
    }
  }
  
  startResetTimer() {
    const updateTimer = () => {
      const now = new Date();
      const tomorrow = new Date(now);
      tomorrow.setDate(tomorrow.getDate() + 1);
      tomorrow.setHours(0, 0, 0, 0);
      
      const diff = tomorrow - now;
      const hours = Math.floor(diff / (1000 * 60 * 60));
      const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
      const seconds = Math.floor((diff % (1000 * 60)) / 1000);
      
      const timeString = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
      
      const countdownEl = document.getElementById('resetCountdown');
      if (countdownEl) {
        countdownEl.textContent = timeString;
      }
    };
    
    updateTimer();
    setInterval(updateTimer, 1000);
  }
}

function showArticleModal() {
  document.getElementById('articleAccessOverlay').classList.remove('hidden');
  document.body.style.overflow = 'hidden';
}

function closeArticleModal() {
  document.getElementById('articleAccessOverlay').classList.add('hidden');
  document.body.style.overflow = '';
}

function selectReadingTier(tier) {
  localStorage.setItem('readingTier', tier);
  
  // Track conversion
  if (window.trackGoal) {
    window.trackGoal('reading_tier_selected', {
      tier: tier,
      price: tier === 'basic' ? 4 : tier === 'premium' ? 12 : 29
    });
  }
  
  // Redirect to subscription
  window.location.href = `/subscribe/?tier=reading-${tier}&feature=article-limits`;
}

function watchVideoForArticle() {
  // Simulate video ad experience
  const videoModal = document.createElement('div');
  videoModal.innerHTML = `
    <div style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 10001; display: flex; align-items: center; justify-content: center;">
      <div style="background: white; padding: 30px; border-radius: 16px; text-align: center; max-width: 500px; width: 90%;">
        <h3>üìπ Sponsored Content</h3>
        <div style="background: #000; height: 280px; display: flex; align-items: center; justify-content: center; margin: 20px 0; border-radius: 12px; color: white; position: relative;">
          <div style="text-align: center;">
            <p style="font-size: 20px; margin: 0;">‚ñ∂Ô∏è Corporate Evil Exposed</p>
            <p style="font-size: 14px; margin: 5px 0 0 0;">Advertisement</p>
          </div>
          <div style="position: absolute; bottom: 10px; right: 10px; background: rgba(0,0,0,0.7); padding: 5px 10px; border-radius: 5px;">
            <span id="videoTimer" style="color: white; font-size: 14px;">60</span>s
          </div>
        </div>
        <div style="margin: 20px 0;">
          <div style="background: #f0f0f0; padding: 15px; border-radius: 8px;">
            <p style="margin: 0; font-weight: bold;">üéØ Earn 1 Article Access</p>
            <p style="margin: 5px 0 0 0; font-size: 12px; color: #666;">Complete video to unlock reading</p>
          </div>
        </div>
      </div>
    </div>
  `;
  
  document.body.appendChild(videoModal);
  
  let countdown = 60;
  const timer = setInterval(() => {
    countdown--;
    const timerEl = document.getElementById('videoTimer');
    if (timerEl) {
      timerEl.textContent = countdown;
    }
    
    if (countdown <= 0) {
      clearInterval(timer);
      document.body.removeChild(videoModal);
      alert('üéâ Video complete! You earned 1 article access!');
      grantTemporaryArticle();
      closeArticleModal();
    }
  }, 1000);
  
  if (window.trackGoal) {
    window.trackGoal('article_video_watched', { feature: 'article_limits' });
  }
}

function shareForArticles() {
  const shareText = `I'm reading incredible investigative journalism on EVIL1.ORG! Check it out: ${window.location.href}`;
  
  if (navigator.share) {
    navigator.share({
      title: 'EVIL1.ORG - Corporate Evil Exposed',
      text: shareText,
      url: window.location.href
    }).then(() => {
      alert('üéâ Thanks for sharing! You earned 2 more articles!');
      grantTemporaryArticles(2);
      closeArticleModal();
    });
  } else {
    navigator.clipboard.writeText(shareText).then(() => {
      alert('üéâ Share text copied! Paste it anywhere to earn 2 articles!');
      grantTemporaryArticles(2);
      closeArticleModal();
    });
  }
  
  if (window.trackGoal) {
    window.trackGoal('article_shared', { feature: 'article_limits' });
  }
}

function takeSurveyForArticles() {
  const surveyModal = document.createElement('div');
  surveyModal.innerHTML = `
    <div style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 10001; display: flex; align-items: center; justify-content: center; padding: 20px;">
      <div style="background: white; padding: 30px; border-radius: 16px; max-width: 500px; width: 100%;">
        <h3 style="margin: 0 0 20px 0;">üìã Quick Reader Survey</h3>
        <div style="margin-bottom: 20px;">
          <label style="display: block; margin-bottom: 10px;">
            <strong>How did you discover EVIL1.ORG?</strong>
          </label>
          <select style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px;">
            <option>Social media</option>
            <option>Search engine</option>
            <option>Friend recommendation</option>
            <option>News article</option>
            <option>Other</option>
          </select>
        </div>
        
        <div style="margin-bottom: 20px;">
          <label style="display: block; margin-bottom: 10px;">
            <strong>What topics interest you most?</strong>
          </label>
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
            <label><input type="checkbox"> Corporate crimes</label>
            <label><input type="checkbox"> Executive accountability</label>
            <label><input type="checkbox"> Consumer protection</label>
            <label><input type="checkbox"> Environmental crimes</label>
          </div>
        </div>
        
        <div style="display: flex; gap: 10px;">
          <button onclick="submitSurvey()" style="flex: 1; background: #00b894; color: white; border: none; padding: 12px; border-radius: 8px; cursor: pointer; font-weight: bold;">
            Submit Survey
          </button>
          <button onclick="closeSurvey()" style="background: #636e72; color: white; border: none; padding: 12px 20px; border-radius: 8px; cursor: pointer;">
            Skip
          </button>
        </div>
      </div>
    </div>
  `;
  
  document.body.appendChild(surveyModal);
  
  window.submitSurvey = () => {
    document.body.removeChild(surveyModal);
    alert('üéâ Survey complete! You earned 3 articles!');
    grantTemporaryArticles(3);
    closeArticleModal();
  };
  
  window.closeSurvey = () => {
    document.body.removeChild(surveyModal);
  };
  
  if (window.trackGoal) {
    window.trackGoal('article_survey_started', { feature: 'article_limits' });
  }
}

function inviteFriendForArticles() {
  const email = prompt('Enter your friend\'s email to invite them to EVIL1.ORG:');
  if (email && email.includes('@')) {
    alert(`üéâ Invitation sent to ${email}! You earned 10 articles!`);
    grantTemporaryArticles(10);
    closeArticleModal();
    
    if (window.trackGoal) {
      window.trackGoal('article_friend_invited', { feature: 'article_limits' });
    }
  }
}

function grantTemporaryArticles(count) {
  const limitSystem = window.dailyArticleLimitSystem;
  if (limitSystem) {
    limitSystem.dailyLimit += count;
    limitSystem.updateStatusBar();
  }
}

function grantTemporaryArticle() {
  grantTemporaryArticles(1);
}

// Initialize article limit system when page loads
document.addEventListener('DOMContentLoaded', function() {
  window.dailyArticleLimitSystem = new DailyArticleLimitSystem();
});

// Add body padding for status bar
document.addEventListener('DOMContentLoaded', function() {
  const userTier = localStorage.getItem('readingTier') || 'free';
  if (userTier === 'free') {
    document.body.style.paddingTop = '60px';
  }
});
</script>